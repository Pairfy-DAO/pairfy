<template>
  <div class="product">
    <MainHeader />
    <div class="product-wrap">
      <div class="product-wrap-top">
        <div class="product-wrap-top-left">
          <Galleria
            :value="images"
            :responsiveOptions="responsiveOptions"
            :numVisible="5"
            :circular="true"
            containerStyle="max-width: 80%"
            :showItemNavigators="true"
            :showThumbnails="false"
          >
            <template #item="slotProps">
              <img
                :src="slotProps.item.itemImageSrc"
                :alt="slotProps.item.alt"
                style="width: 100%; display: block"
              />
            </template>
            <template #thumbnail="slotProps">
              <img
                :src="slotProps.item.thumbnailImageSrc"
                :alt="slotProps.item.alt"
                style="display: block"
              />
            </template>
          </Galleria>
        </div>

        <div class="product-wrap-top-right">
          <div class="product-name">
            LG - 65‚Äù Class UQ70 Series LED 4K UHD Smart webOS TV

            <div @click="buyProduct1('1')">send1</div>
            <div @click="buyProduct1('2')">send2</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import productAPI from "@/pages/product/api";
import MainHeader from "@/components/MainHeader.vue";
import { ref } from "vue";
import { Lucid, getAddressDetails } from "lucid-cardano";
import { balanceTx } from "@/api/wallet-api";

export default {
  components: {
    MainHeader,
  },
  setup() {
    const { lockingEndpoint } = productAPI();

    const images = ref([
      {
        itemImageSrc:
          "https://pisces.bbystatic.com/image2/BestBuy_US/images/products/6501/6501938_rd.jpg",
        thumbnailImageSrc:
          "https://pisces.bbystatic.com/image2/BestBuy_US/images/products/6501/6501938_rd.jpg",
        alt: "Description for Image 1",
        title: "Title 1",
      },
      {
        itemImageSrc:
          "https://pisces.bbystatic.com/image2/BestBuy_US/images/products/6553/6553101_sd.jpg",
        thumbnailImageSrc:
          "https://pisces.bbystatic.com/image2/BestBuy_US/images/products/6553/6553101_sd.jpg",
        alt: "Description for Image 2",
        title: "Title 2",
      },
      {
        itemImageSrc:
          "https://pisces.bbystatic.com/image3/BestBuy_US/images/products/6537/6537363_sd.jpg",
        thumbnailImageSrc:
          "https://pisces.bbystatic.com/image3/BestBuy_US/images/products/6537/6537363_sd.jpg",
        alt: "Description for Image 3",
        title: "Title 3",
      },
    ]);

    const responsiveOptions = ref([
      {
        breakpoint: "991px",
        numVisible: 4,
      },
      {
        breakpoint: "767px",
        numVisible: 3,
      },
      {
        breakpoint: "575px",
        numVisible: 1,
      },
    ]);

    return {
      images,
      lockingEndpoint,
      responsiveOptions,
    };
  },
  data() {
    return {
      lucid: null,
      slot_id: "",
      buyer_pubkeyhash: "",
      tx1: "84a400800181a300581d70e8c60f12bef35af261cdbc7ca78141202aa8bb3d111134274e981563011a01312d08028201d8185841d8799f004777616974696e67d87980d87980d87980581c4068ce72a0f73e850f19899a10b82ec534a55a6d860e5c5267dca2b9d87a801a01c9c3881a01312d08ff02000e81581c4068ce72a0f73e850f19899a10b82ec534a55a6d860e5c5267dca2b9a0f5f6",
      tx2: "84a50081825820d9465a8e6df24a0f5d206aeba3eeda61305350ed9dca9bfd17c0e72e2316d94e000181a300581d70e8c60f12bef35af261cdbc7ca78141202aa8bb3d111134274e981563011a02faf090028201d8185860d8799f01476c6f636b696e67d87a80d87980d87980581c4068ce72a0f73e850f19899a10b82ec534a55a6d860e5c5267dca2b9d8799f581cc204f7b5f051b78d847f5886be97dc08153f811cbdfa5f5dca4ace70ff1a01c9c3881a01312d08ff02000e81581cc204f7b5f051b78d847f5886be97dc08153f811cbdfa5f5dca4ace700b5820371985977efbe50328c0a0c3c88e6b60b2d97333a961a58364da0950aac52923a20681591a7d591a7a010000332323232323232323232323322323232323232322232323232323232323232232322323253353330123357389211944617461206465636f646564207375636365737366756c6c79003333573466e1d401d20042122200223333573466e1d402120022122200323333573466e1d402520002333333333222222222122233333333300100c00b00a009008007006005004375a6ae854048dd71aba15011301635742a020602c6ae85403cc058d5d0a8071bae35742a01a66a034eb8d5d0a8061bad35742a0166eb4d5d09aba2500b23263202733573804e05004a04804666ae7124011d52656465656d6572206465636f646564207375636365737366756c6c79003333573466e1d401120042122200123333573466e1d401520022122200323333573466e1d4019200023212223002004375c6ae84d55cf280411931901399ab9c0270280250240233357389212353637269707420636f6e74657874206465636f646564207375636365737366756c6c79003333573466e1cd55cea80124000466442466002006004646464646464646464646464646666ae68cdc39aab9d500c480008cccccccccccc88888888888848cccccccccccc00403403002c02802402001c01801401000c008cd408c090d5d0a80619a8118121aba1500b33502302535742a014666aa050eb9409cd5d0a804999aa8143ae502735742a01066a04605c6ae85401cccd540a00bdd69aba150063232323333573466e1cd55cea801240004664424660020060046464646666ae68cdc39aab9d5002480008cc8848cc00400c008cd40e5d69aba15002302a357426ae8940088c98c80eccd5ce01d81e01c89aab9e5001137540026ae854008c8c8c8cccd5cd19b8735573aa004900011991091980080180119a81cbad35742a00460546ae84d5d1280111931901d99ab9c03b03c039135573ca00226ea8004d5d09aba2500223263203733573806e07006a26aae7940044dd50009aba1500533502375c6ae854010ccd540a00ac8004d5d0a801999aa8143ae200135742a004605a6ae84d5d1280111931901999ab9c033034031135744a00226ae8940044d5d1280089aba25001135744a00226ae8940044d5d1280089aba25001135744a00226ae8940044d55cf280089baa00135742a004603a6ae84d5d1280111931901299ab9c02502602310251326320243357389210350543500025135573ca00226ea80044d55cea80089baa001135573aa01226ae8940044d5d1280089aba25001135744a00226ae8940044d5d1280089aba25001135573ca00226ea80048c8cccd5cd19b8750014800884880088cccd5cd19b8750024800084880048c98c8054cd5ce00a80b00980909aab9d37540022464460046eb0004c8004d5404c88cccd55cf80092805919a80518021aba1002300335744004028464646666ae68cdc39aab9d5002480008cc8848cc00400c008c030d5d0a80118029aba135744a004464c6402666ae7004c0500444d55cf280089baa0012323232323333573466e1cd55cea8022400046666444424666600200a0080060046464646666ae68cdc39aab9d5002480008cc8848cc00400c008c054d5d0a80119a80580a1aba135744a004464c6403066ae700600640584d55cf280089baa00135742a008666aa012eb94020d5d0a8019919191999ab9a3370ea0029002119091118010021aba135573ca00646666ae68cdc3a80124004464244460020086eb8d5d09aab9e500423333573466e1d400d20002122200323263201a33573803403603002e02c26aae7540044dd50009aba1500233500775c6ae84d5d1280111931900a19ab9c014015012135744a00226ae8940044d55cf280089baa00112232323333573466e1d4005200023212230020033005357426aae79400c8cccd5cd19b8750024800884880048c98c804ccd5ce00980a00880809aab9d500113754002266aa002eb9d6889119118011bab0013200135500f223233335573e0044a010466a00e66442466002006004600c6aae754008c014d55cf280118021aba2003011135742002224400424424466002008006464646666ae68cdc3a800a400c46424444600800a600e6ae84d55cf280191999ab9a3370ea004900211909111180100298049aba135573ca00846666ae68cdc3a801a400446424444600200a600e6ae84d55cf280291999ab9a3370ea00890001190911118018029bae357426aae7940188c98c803ccd5ce00780800680600580509aab9d500113754002464646666ae68cdc39aab9d5002480008cc8848cc00400c008c014d5d0a8011bad357426ae8940088c98c802ccd5ce00580600489aab9e5001137540024646666ae68cdc39aab9d5001480008dd71aba135573ca004464c6401266ae7002402801c4dd5000919191919191999ab9a3370ea002900610911111100191999ab9a3370ea004900510911111100211999ab9a3370ea00690041199109111111198008048041bae35742a00a6eb4d5d09aba2500523333573466e1d40112006233221222222233002009008375c6ae85401cdd71aba135744a00e46666ae68cdc3a802a400846644244444446600c01201060186ae854024dd71aba135744a01246666ae68cdc3a8032400446424444444600e010601a6ae84d55cf280591999ab9a3370ea00e900011909111111180280418071aba135573ca018464c6402466ae7004804c04003c03803403002c0284d55cea80209aab9e5003135573ca00426aae7940044dd50009191919191999ab9a3370ea002900111999110911998008028020019bad35742a0086eb4d5d0a8019bad357426ae89400c8cccd5cd19b875002480008c8488c00800cc020d5d09aab9e500623263200b33573801601801201026aae75400c4d5d1280089aab9e500113754002464646666ae68cdc3a800a400446424460020066eb8d5d09aab9e500323333573466e1d400920002321223002003375c6ae84d55cf280211931900419ab9c008009006005135573aa00226ea8004488c8c8cccd5cd19b87500148010848880048cccd5cd19b875002480088c84888c00c010c018d5d09aab9e500423333573466e1d400d20002122200223263200933573801201400e00c00a26aae7540044dd5000a4c9201035054310012001112323001001223300330020020013323322323232323232323232323232323332223232323232323233223233223232323232323232323232323233223232323232323232323232323232323232323232323232232222323500522223232533533300400a00900815001153353357389210253310004f15001104f1533532325335004232133302302032323001005320013550552253350011503a22135002225335333573466e3c00801c1681644cd40f4cd5415001c00540f84c01800d4004cd40d8cd541354004cd40d8cd5413401120025037503713500122001105150073011007150011533533573892010253320004e15001104e153353300433501200833301901a500532335530261200123500122335504c002335530291200123500122335504f00233704900080080080099a8078009808003003909a80091911a80091299a98048010a99a999aa981b090009a817a81711a80091199aa981c890009a819281891a80091199ab9a3370e900000082d02c8008008a8020a99a99ab9c4901025333000531500410531350052222533533333335501e501d25333500113374a90011bb105413374a90021bb105422222222213374a900019aba0375001266ae80dd480419aba0305a00733574060b400c66ae80c168014cd5d01ba9004335740a66a0064266e9520003357406ea4004dd882f099ba548008dd882e99aba0375000466ae80dd40009bb105d0040030023501612233002333222123330010040030023502900833302502600733501b00d301c0125040001010105813357389201025335000571350012222533533333335501a5019501900400300200100c1054133573892102533400053133573892010253360004d1533530100012135001223500122220031326320453357389210253300004532123333001223500222533350021503115031222222222323215333500e13001498854cd4ccd5cd19b8700c4800015c1584d40f8cd54144d54050004cd406d4ccd403858588888888884ccccccccc08120024881076c6f636b696e67000600060050043504700a00200133302202300d33503a335505101633503a3355051016005503b503b130024984c0052625333500e15335333573466e1c02d200205605513503d335505035501300633501a5333500d1616222222222133333333301f4801122010964656c6976657265640000705f00500400300200100c1300249884c00d261300249894cd4010854ccd4038540f08540f454cd4ccd5cd19b8700b480101581544d40f4cd54140c8c8d4cccc888848cccc00401401000c008d40088888ccd54c0bc4800540fcd40148888010010d40088888ccd54c0bc4800540fcd4014888800c00cd40088888ccd54c0bc4800540fcd40148888008008d40088888ccd54c0bc4800540fcd401488880040048888cccd5407c01000c008004cccd54068d4054488cc008cccc09cc848cc004488c00803400940fd40fd40fccd40f0cd5414c060cd40f0cd5414c060cdc0003003a81ea81e800a81da81da81d9aa80980099a80d0911001281d0a81e0a81d92999a80088238824111111111082811102500128158891999aa8039a80109119801091111111111111806808000a814281428140919a800a8132813a44100222222222122233333333300100c00b00a009008007006005004125335001212335025335503c3500222001335025335503c00148009409940984940948d54cd4c01800484d400488d40048888d401088cd40088c1092623355043001005130384988800844888848cccc00401401000c00848848cc00400c0084940044488888894cd4ccd54c08c48004d4071406c8d400888cc03000800c01454cd4ccd54c08c48004d4071406cd4004888d40048888d401c8888888888894cd4ccd54c0d848004d40a940b08d400488d40048888d401088cd400881748c94ccd40184178854cd4cc0f000407c84c00c008417c854cd4cc0f400407c84c00c004417c94cd4ccd5cd19b8f01b00205f05e1533530190071301a001105e105e00c15335333553036120013502a502c23230010053200135505622533500110562213500222333350022300700423007004230070042533533045001350082200213303a0150021300700400c1054150511505100415335333553023120013501c501b235002223500322253353300f005321222222222222233300301000e00f300d00310471335738921024c300004600315335333553023120013501c501b2350012225335300c0052135001223500122223500c22533533016002333301c00635035333500c23212223003004301400123212223002004301400123501e301400100a00b104e1504c1504300210411503815038150381503823500122350022222222222223333500d2502f2502f2502f233355302b12001502e235001225335330350020041350330031503200d32001355039222333333333333350012533535003222222222222533533355302a12001502d25335333573466e3c0380041241204d40c0004540bc01084124411c40f04cd5ce2481024c340003b235003222222222222533533355302a120013501e5020302600d3355301f120012350012200100210481335738921024c32000472253353301a002004215335333573466ebc0040080f80f440f8540c0540bc888c8c8894cd4ccd5cd19b8735009222222222222300f008002042041153350012153353302300100a210441503610421503532001355040223350014800088d4008894cd4ccd5cd19b8f00200a04504413007001130060033200135503f223350014800088d4008894cd4ccd5cd19b8f0020070440431001130060032222533533300f01e00133355301212001500950233500622222222222233355301e120012235002222253353500422350182232335005233500425335333573466e3c00800416015c5400c415c815c8cd4010815c94cd4ccd5cd19b8f0020010580571500310571533500321533500221335002233500223350022335002233034002001205a2335002205a23303400200122205a222335004205a2225335333573466e1c01800c17417054cd4ccd5cd19b8700500205d05c13302a004001105c105c10551533500121055105513350340030051005502f00a153350032135007222222222222533533355302e120013502250242333500e235002222253335002105121052210532350022222533350021051210522153353302f00601a213302d0010021052235002222253335002105121330310060012105200a104c15040103f150332533533300c01b0013500322222222222233355302a120015011235001222200300a103c1335738921024c360003b253353301c0010032103d1335738921024c660003b2533533355301e120013501250143355301e12001350175016233005004001001103c1335738921024c640003b2533533300c01b0013500322222222222233355302a1200150112350012235001222200300c103c1335738921024c350003b253353301d00100321350012235001222253335002104321503921503915031222323001350062222222222220033200135503f22533500115036221350022233335002230070042300700423007004253353302e00100a15335333573466ebc02400811411054cd4cc098028030854cd4024854cd4cc09c00403884120540f44118540ec540ec4c01c01080f08d400c888888888888d403488c94cd400c84cc008d40e40041304cc004488800812c88d402488d4008894cd4c8c94ccd4ccd40f800802001054cd400c54cd401c4ccd40f000801400441444ccd40f000801400441444ccd40f00080140054cd402084cd40f4d40fc0041444cd40f0488800414448cccccccc004078894cd4ccd5cd19b87002001053052104415335333573466e2400800414c1484108410c88ccd5cd19b8800200105305203022333573466e2400800414814c88ccd5cd19b88002001052053225335333573466e2400800414c14840044008894cd4ccd5cd19b890020010530521002100110501335738921024c330004f133501f5001501b130010022223355300f120012350012233550350023355301212001235001223355038002333500123300a4800000488cc02c0080048cc028005200000133009002001223370000400244666ae68cdc380100081a81a11110911111111111119998048088080078070909111800802111199aa980a890009a807280691a80091199aa980c090009a808a80811a80091199a8009198052400000244660160040024660140029000000998020010009119aa98040900091a8009119aa817001199a800919aa98060900091a8009119aa8190011aa80680080091199aaa804007801000919aa98060900091a8009119aa8190011aa806000800999aaa801805001000888911199aa980209000a80a19aa98040900091a8009119aa8170011aa804800999aa980209000911a80111299a999aa980b890009a805a80691a80091198050010028030801899a80c002001a80a80099aa98040900091a800911919aa8178019800802990009aa81a91299a80089aa8050019109a80111299a99806001004089111980100500209803001801190009aa8171108911299a800880111099802801199aa98038900080280200088909111801802089091118008020919a80991199a801910010010009a80091000990009aa815110891299a8008a80891099a809180200119aa9803090008020008891980091299a8010815880081411199ab9a3371e0040020520502246600244a66a0042002205004e2466a01c44666a006440040040026a00244002446a002444444444444a66a666aa602824002a02e46a00244a66a666ae68cdd780080881a81a09a80e0018a80d801109a80d1a800910010a80c11911a8009111111111111807001190009aa81291299a8008a8061109a80111299a999ab9a3371e00400e05405226a0220022600c00644666ae68cdd780100081201191199ab9a33712004002046044446a002444444444444666aa602024002a02646a00244a66a6603400402226a0300062a02e016446a002444444444444666aa601e24002a02446a00244a66a6603200402226a02e0062a02c018640026aa03e4422444a66a00226a00644002442666a00a440046008004666aa600e2400200a008002224400424424466002008006266a00644a66a004420062002a0022424460040062244002244246600200600444a66a666ae68cdc79a801110011a8009100100c80c0999ab9a3370e6a004440026a00244002032030203024446a004446a00644a666a666a01200e0080042a66a0062002203a2038203a2442466002006004244464646464a666a00c42a666a00c42a666a0104260089309801a4c2a666a00e4260089309801a4c201c20182a666a00e4260089309801a4c2a666a00c4260089309801a4c201a2a666a00a42016201820142a666a00a42a666a00e42600a930980224c2a666a00c42600a930980224c201a20162a666a00c42600a930980224c2a666a00a42600a930980224c20184a666a00a42a666a00e42a666a00e42666a0180140040022c2c2c20182a666a00c42a666a00c42666a0160120040022c2c2c201620144a666a00842a666a00c42a666a00c42666a0160120040022c2c2c20162a666a00a42a666a00a42666a0140100040022c2c2c201420124a666a00642a666a00a42a666a00a42666a0140100040022c2c2c20142a666a00842a666a00842666a01200e0040022c2c2c201220104a666a00442a666a00842a666a00842666a01200e0040022c2c2c20122a666a00642a666a00642666a01000c0040022c2c2c2010200e2424446006008246a0024444444400e244400624440042444002266ae71241024c630000d13357389201024c390000c13357389201024c610000b13357389201024c370000a13357389201024c380000913357389201024c21000082533500113374a90011bb100413374a90001bb10042326320043357389201024c670000411221233001003002498480044cd5ce2481024c650000213357389201024c3100001122002122001112323001001223300330020020013335122233512233330024891c4068ce72a0f73e850f19899a10b82ec534a55a6d860e5c5267dca2b9005004482423b38712090b4891322221233330010050040030022001121223002003112200112001010581840000d8799f581cc204f7b5f051b78d847f5886be97dc08153f811cbdfa5f5dca4ace70ff821a0018333c1a18f1cb78f5f6",
    };
  },

  created() {
    this.$watch(
      () => this.$route.params,
      (e) => (this.slot_id = e.id),
      { immediate: true }
    )();
  },
  methods: {
    async setupLucid() {
      this.lucid = await Lucid.new();
    },
    async setupWallet() {
      const api = await window.cardano.nami.enable();

      this.lucid.selectWallet(api);
    },
    async buyProduct() {
      const addr = await this.lucid.wallet.address();
      const address = await getAddressDetails(addr);

      this.buyer_pubkeyhash = address.paymentCredential.hash;

      const params = {
        slot_id: this.slot_id,
        buyer_pubkeyhash: address.paymentCredential.hash,
      };

      this.lockingEndpoint(params)
        .then((res) => balanceTx(res.response.payload.transaction))
        .then((tx) => console.log(tx))
        .catch((err) => console.log(err));
    },

    async buyProduct1(e) {
      const addr = await this.lucid.wallet.address();
      const address = await getAddressDetails(addr);

      this.buyer_pubkeyhash = address.paymentCredential.hash;

      if (e === "1") {
        await balanceTx(this.tx1)
          .then((tx) => console.log(tx))
          .catch((err) => console.log(err));
      }

      if (e === "2") {
        await balanceTx(this.tx2)
          .then((tx) => console.log(tx))
          .catch((err) => console.log(err));
      }
    },
  },

  mounted() {
    this.setupLucid();

    this.setupWallet();
  },
};
</script>

<style lang="css" scoped>
.product {
  display: flex;
  justify-content: center;
  min-height: 100vh;
}

.product-wrap {
  width: 80%;
}

.product-wrap-top-left {
  height: inherit;
  text-align: center;
  width: 60%;
  display: flex;
  justify-content: center;
  align-items: center;
}

.product-wrap-top-right {
  height: inherit;
  text-align: center;
  width: 40%;
}

.product-wrap-top {
  height: 800px;
  margin-top: 84px;
  display: flex;
  flex-wrap: wrap;
  border: 1px solid var(--border-a);
  justify-content: space-between;
}

.product-name {
  font-size: var(--text-size-g);
  font-weight: 700;
  margin-top: 4rem;
  text-align: left;
}
</style>
